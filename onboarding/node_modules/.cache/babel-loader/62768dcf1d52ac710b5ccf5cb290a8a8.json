{"ast":null,"code":"import _slicedToArray from \"/home/elijah/Documents/Lambda-Labs/project-firefly-fe/onboarding/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"/home/elijah/Documents/Lambda-Labs/project-firefly-fe/onboarding/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _jsxFileName = \"/home/elijah/Documents/Lambda-Labs/project-firefly-fe/onboarding/src/auth0/react-auth0-spa.js\";\n// src/react-auth0-spa.js\nimport React, { useState, useEffect, useContext } from \"react\";\nimport createAuth0Client from \"@auth0/auth0-spa-js\";\n\nconst DEFAULT_REDIRECT_CALLBACK = () => window.history.replaceState({}, document.title, window.location.pathname);\n\nexport const Auth0Context = React.createContext();\nexport const useAuth0 = () => useContext(Auth0Context);\nexport const Auth0Provider = (_ref) => {\n  let children = _ref.children,\n      _ref$onRedirectCallba = _ref.onRedirectCallback,\n      onRedirectCallback = _ref$onRedirectCallba === void 0 ? DEFAULT_REDIRECT_CALLBACK : _ref$onRedirectCallba,\n      initOptions = _objectWithoutProperties(_ref, [\"children\", \"onRedirectCallback\"]);\n\n  const _useState = useState(),\n        _useState2 = _slicedToArray(_useState, 2),\n        isAuthenticated = _useState2[0],\n        setIsAuthenticated = _useState2[1];\n\n  const _useState3 = useState(),\n        _useState4 = _slicedToArray(_useState3, 2),\n        user = _useState4[0],\n        setUser = _useState4[1];\n\n  const _useState5 = useState(),\n        _useState6 = _slicedToArray(_useState5, 2),\n        auth0Client = _useState6[0],\n        setAuth0 = _useState6[1];\n\n  const _useState7 = useState(true),\n        _useState8 = _slicedToArray(_useState7, 2),\n        loading = _useState8[0],\n        setLoading = _useState8[1];\n\n  const _useState9 = useState(false),\n        _useState10 = _slicedToArray(_useState9, 2),\n        popupOpen = _useState10[0],\n        setPopupOpen = _useState10[1];\n\n  useEffect(() => {\n    const initAuth0 = async () => {\n      const auth0FromHook = await createAuth0Client(initOptions);\n      setAuth0(auth0FromHook);\n\n      if (window.location.search.includes(\"code=\")) {\n        const _ref2 = await auth0FromHook.handleRedirectCallback(),\n              appState = _ref2.appState;\n\n        onRedirectCallback(appState);\n      }\n\n      const isAuthenticated = await auth0FromHook.isAuthenticated();\n      setIsAuthenticated(isAuthenticated);\n\n      if (isAuthenticated) {\n        const user = await auth0FromHook.getUser();\n        setUser(user);\n      }\n\n      setLoading(false);\n    };\n\n    initAuth0(); // eslint-disable-next-line\n  }, []);\n\n  const loginWithPopup = async (params = {}) => {\n    setPopupOpen(true);\n\n    try {\n      await auth0Client.loginWithPopup(params);\n    } catch (error) {\n      console.error(error);\n    } finally {\n      setPopupOpen(false);\n    }\n\n    const user = await auth0Client.getUser();\n    setUser(user);\n    setIsAuthenticated(true);\n  };\n\n  const handleRedirectCallback = async () => {\n    setLoading(true);\n    await auth0Client.handleRedirectCallback();\n    const user = await auth0Client.getUser();\n    setLoading(false);\n    setIsAuthenticated(true);\n    setUser(user);\n  };\n\n  return React.createElement(Auth0Context.Provider, {\n    value: {\n      isAuthenticated,\n      user,\n      loading,\n      popupOpen,\n      loginWithPopup,\n      handleRedirectCallback,\n      getIdTokenClaims: (...p) => auth0Client.getIdTokenClaims(...p),\n      loginWithRedirect: (...p) => auth0Client.loginWithRedirect(...p),\n      getTokenSilently: (...p) => auth0Client.getTokenSilently(...p),\n      getTokenWithPopup: (...p) => auth0Client.getTokenWithPopup(...p),\n      logout: (...p) => auth0Client.logout(...p)\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69\n    },\n    __self: this\n  }, children);\n};","map":{"version":3,"sources":["/home/elijah/Documents/Lambda-Labs/project-firefly-fe/onboarding/src/auth0/react-auth0-spa.js"],"names":["React","useState","useEffect","useContext","createAuth0Client","DEFAULT_REDIRECT_CALLBACK","window","history","replaceState","document","title","location","pathname","Auth0Context","createContext","useAuth0","Auth0Provider","children","onRedirectCallback","initOptions","isAuthenticated","setIsAuthenticated","user","setUser","auth0Client","setAuth0","loading","setLoading","popupOpen","setPopupOpen","initAuth0","auth0FromHook","search","includes","handleRedirectCallback","appState","getUser","loginWithPopup","params","error","console","getIdTokenClaims","p","loginWithRedirect","getTokenSilently","getTokenWithPopup","logout"],"mappings":"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","sourcesContent":["// src/react-auth0-spa.js\r\nimport React, { useState, useEffect, useContext } from \"react\";\r\nimport createAuth0Client from \"@auth0/auth0-spa-js\";\r\n\r\nconst DEFAULT_REDIRECT_CALLBACK = () =>\r\n    window.history.replaceState({}, document.title, window.location.pathname);\r\n\r\nexport const Auth0Context = React.createContext();\r\nexport const useAuth0 = () => useContext(Auth0Context);\r\nexport const Auth0Provider = ({\r\n    children,\r\n    onRedirectCallback = DEFAULT_REDIRECT_CALLBACK,\r\n    ...initOptions\r\n}) => {\r\n    const [isAuthenticated, setIsAuthenticated] = useState();\r\n    const [user, setUser] = useState();\r\n    const [auth0Client, setAuth0] = useState();\r\n    const [loading, setLoading] = useState(true);\r\n    const [popupOpen, setPopupOpen] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const initAuth0 = async () => {\r\n            const auth0FromHook = await createAuth0Client(initOptions);\r\n            setAuth0(auth0FromHook);\r\n\r\n            if (window.location.search.includes(\"code=\")) {\r\n                const { appState } = await auth0FromHook.handleRedirectCallback();\r\n                onRedirectCallback(appState);\r\n            }\r\n\r\n            const isAuthenticated = await auth0FromHook.isAuthenticated();\r\n\r\n            setIsAuthenticated(isAuthenticated);\r\n\r\n            if (isAuthenticated) {\r\n                const user = await auth0FromHook.getUser();\r\n                setUser(user);\r\n            }\r\n\r\n            setLoading(false);\r\n        };\r\n        initAuth0();\r\n        // eslint-disable-next-line\r\n    }, []);\r\n\r\n    const loginWithPopup = async (params = {}) => {\r\n        setPopupOpen(true);\r\n        try {\r\n            await auth0Client.loginWithPopup(params);\r\n        } catch (error) {\r\n            console.error(error);\r\n        } finally {\r\n            setPopupOpen(false);\r\n        }\r\n        const user = await auth0Client.getUser();\r\n        setUser(user);\r\n        setIsAuthenticated(true);\r\n    };\r\n\r\n    const handleRedirectCallback = async () => {\r\n        setLoading(true);\r\n        await auth0Client.handleRedirectCallback();\r\n        const user = await auth0Client.getUser();\r\n        setLoading(false);\r\n        setIsAuthenticated(true);\r\n        setUser(user);\r\n    };\r\n    return (\r\n        <Auth0Context.Provider\r\n            value={{\r\n                isAuthenticated,\r\n                user,\r\n                loading,\r\n                popupOpen,\r\n                loginWithPopup,\r\n                handleRedirectCallback,\r\n                getIdTokenClaims: (...p) => auth0Client.getIdTokenClaims(...p),\r\n                loginWithRedirect: (...p) => auth0Client.loginWithRedirect(...p),\r\n                getTokenSilently: (...p) => auth0Client.getTokenSilently(...p),\r\n                getTokenWithPopup: (...p) => auth0Client.getTokenWithPopup(...p),\r\n                logout: (...p) => auth0Client.logout(...p)\r\n            }}\r\n        >\r\n            {children}\r\n        </Auth0Context.Provider>\r\n    );\r\n};"]},"metadata":{},"sourceType":"module"}